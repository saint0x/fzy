use core.fs;
use core.time;
fn append_event() -> i32 {
    let h = fs.open() defer close(h) fs.write() fs.flush() return 0
}
fn rotate_segment() -> i32 {
    let h = fs.open() defer close(h) fs.atomic_write() fs.rename_atomic() fs.fsync() time.now() return 0
}
